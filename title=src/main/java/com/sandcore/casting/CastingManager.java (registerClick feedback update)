public void registerClick(Player player, String clickType) {
    UUID uuid = player.getUniqueId();
    if (!isInCastingMode(player))
        return;
    StringBuilder combo = clickCombos.getOrDefault(uuid, new StringBuilder());
    if (combo.length() > 0) {
        combo.append(",");
    }
    combo.append(clickType);
    clickCombos.put(uuid, combo);

    // Provide visual feedback with the current combo via the action bar.
    player.sendActionBar("Current Combo: " + combo.toString());
    // Play a button click sound to indicate a new click was registered.
    player.playSound(player.getLocation(), Sound.BLOCK_STONE_BUTTON_CLICK_ON, 1.0F, 1.0F);

    // Check if the combo now has exactly three clicks.
    String comboStr = combo.toString();
    int count = comboStr.split(",").length;
    if (count == 3) {
        // Cancel any existing scheduled task for this player.
        if (comboTasks.containsKey(uuid)) {
            comboTasks.get(uuid).cancel();
            comboTasks.remove(uuid);
        }
        processCombo(player, comboStr);
        clickCombos.remove(uuid);
        return;
    }
    
    // Cancel any existing scheduled task for this player.
    if (comboTasks.containsKey(uuid)) {
        comboTasks.get(uuid).cancel();
    }
    
    // Schedule processing after the timeout.
    BukkitTask task = plugin.getServer().getScheduler().runTaskLater(plugin, () -> {
        processCombo(player, combo.toString());
        clickCombos.remove(uuid);
        comboTasks.remove(uuid);
    }, comboTimeout);
    comboTasks.put(uuid, task);
} 